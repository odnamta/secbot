{
  "targetUrl": "https://atmando-finance.vercel.app/",
  "profile": "standard",
  "startedAt": "2026-02-19T15:21:44.170Z",
  "completedAt": "2026-02-19T15:22:24.752Z",
  "pagesScanned": 1,
  "rawFindings": [
    {
      "id": "4742500d-64d5-447d-84e9-5f010fd4103c",
      "category": "security-headers",
      "severity": "medium",
      "title": "CSP Allows Unsafe Inline Scripts",
      "description": "The Content-Security-Policy includes 'unsafe-inline', which weakens XSS protection.",
      "url": "https://atmando-finance.vercel.app/",
      "evidence": "CSP: default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://*.supabase.co https://*.supabase.in wss://*.supabase.co; frame-ancestors 'none'; base-uri 'self'; form-action 'self'",
      "response": {
        "status": 307,
        "headers": {
          "cache-control": "public, max-age=0, must-revalidate",
          "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://*.supabase.co https://*.supabase.in wss://*.supabase.co; frame-ancestors 'none'; base-uri 'self'; form-action 'self'",
          "content-type": "text/html",
          "date": "Thu, 19 Feb 2026 15:21:47 GMT",
          "location": "/login",
          "permissions-policy": "camera=(), microphone=(), geolocation=(), interest-cohort=()",
          "referrer-policy": "strict-origin-when-cross-origin",
          "server": "Vercel",
          "strict-transport-security": "max-age=63072000; includeSubDomains; preload",
          "x-content-type-options": "nosniff",
          "x-frame-options": "DENY",
          "x-vercel-id": "sin1::xg75m-1771514507328-6d2a123710cd"
        }
      },
      "timestamp": "2026-02-19T15:22:00.678Z"
    },
    {
      "id": "e221a7e1-d822-41a4-ab2c-be3b7defd003",
      "category": "security-headers",
      "severity": "medium",
      "title": "CSP Allows Unsafe Eval",
      "description": "The Content-Security-Policy includes 'unsafe-eval', allowing dynamic code execution.",
      "url": "https://atmando-finance.vercel.app/",
      "evidence": "CSP: default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://*.supabase.co https://*.supabase.in wss://*.supabase.co; frame-ancestors 'none'; base-uri 'self'; form-action 'self'",
      "response": {
        "status": 307,
        "headers": {
          "cache-control": "public, max-age=0, must-revalidate",
          "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://*.supabase.co https://*.supabase.in wss://*.supabase.co; frame-ancestors 'none'; base-uri 'self'; form-action 'self'",
          "content-type": "text/html",
          "date": "Thu, 19 Feb 2026 15:21:47 GMT",
          "location": "/login",
          "permissions-policy": "camera=(), microphone=(), geolocation=(), interest-cohort=()",
          "referrer-policy": "strict-origin-when-cross-origin",
          "server": "Vercel",
          "strict-transport-security": "max-age=63072000; includeSubDomains; preload",
          "x-content-type-options": "nosniff",
          "x-frame-options": "DENY",
          "x-vercel-id": "sin1::xg75m-1771514507328-6d2a123710cd"
        }
      },
      "timestamp": "2026-02-19T15:22:00.678Z"
    }
  ],
  "interpretedFindings": [
    {
      "title": "Content Security Policy Weakened by Unsafe Directives",
      "severity": "medium",
      "confidence": "high",
      "owaspCategory": "A03:2021 â€“ Injection",
      "description": "The Content-Security-Policy (CSP) header includes both 'unsafe-inline' and 'unsafe-eval' in the script-src directive. These directives significantly weaken XSS protection by allowing inline JavaScript execution and dynamic code evaluation (eval, Function constructor, setTimeout with strings). This defeats much of the purpose of having a CSP.",
      "impact": "If an attacker finds any XSS vulnerability in the application, the weakened CSP will not prevent exploitation. 'unsafe-inline' allows injected <script> tags and event handlers to execute. 'unsafe-eval' allows string-to-code execution, enabling more sophisticated attacks. This reduces defense-in-depth and makes the application more vulnerable to stored, reflected, or DOM-based XSS attacks.",
      "reproductionSteps": [
        "Navigate to https://atmando-finance.vercel.app/",
        "Open browser DevTools and check the Network tab",
        "Inspect the response headers for the main document",
        "Observe the CSP header contains: script-src 'self' 'unsafe-eval' 'unsafe-inline'"
      ],
      "suggestedFix": "Remove 'unsafe-inline' and 'unsafe-eval' from the CSP. For Next.js applications, this requires refactoring inline scripts and styles. Use nonces or hashes for necessary inline scripts, and avoid eval() and similar constructs. Next.js 13+ with App Router has better CSP support built-in.",
      "codeExample": "// In next.config.js or middleware.ts\nconst cspHeader = `\n  default-src 'self';\n  script-src 'self' 'nonce-${nonce}';\n  style-src 'self' 'nonce-${nonce}';\n  img-src 'self' data: https:;\n  font-src 'self' data:;\n  connect-src 'self' https://*.supabase.co https://*.supabase.in wss://*.supabase.co;\n  frame-ancestors 'none';\n  base-uri 'self';\n  form-action 'self';\n  upgrade-insecure-requests;\n`;\n\n// Generate a unique nonce per request in middleware\nexport function middleware(request) {\n  const nonce = Buffer.from(crypto.randomUUID()).toString('base64');\n  const cspHeaderValue = cspHeader.replace(/\\${nonce}/g, nonce);\n  \n  const requestHeaders = new Headers(request.headers);\n  requestHeaders.set('x-nonce', nonce);\n  requestHeaders.set('Content-Security-Policy', cspHeaderValue);\n  \n  return NextResponse.next({\n    request: { headers: requestHeaders },\n    headers: { 'Content-Security-Policy': cspHeaderValue }\n  });\n}\n\n// In your layout/page components, use the nonce:\n// <script nonce={nonce}>...</script>",
      "affectedUrls": [
        "https://atmando-finance.vercel.app/"
      ],
      "rawFindingIds": [
        "4742500d-64d5-447d-84e9-5f010fd4103c",
        "e221a7e1-d822-41a4-ab2c-be3b7defd003"
      ]
    }
  ],
  "summary": {
    "totalRawFindings": 2,
    "totalInterpretedFindings": 1,
    "bySeverity": {
      "critical": 0,
      "high": 0,
      "medium": 1,
      "low": 0,
      "info": 0
    },
    "topIssues": [
      "Strengthen Content Security Policy by removing 'unsafe-inline' and 'unsafe-eval' directives to improve XSS protection"
    ]
  },
  "recon": {
    "techStack": {
      "server": "Vercel",
      "cdn": "Vercel",
      "languages": [],
      "detected": [
        "Server: Vercel",
        "CDN: Vercel",
        "Next.js"
      ]
    },
    "waf": {
      "detected": false,
      "confidence": "medium",
      "evidence": []
    },
    "framework": {
      "name": "Next.js",
      "confidence": "high",
      "evidence": [
        "Next.js script bundle detected"
      ]
    },
    "endpoints": {
      "pages": [
        "https://atmando-finance.vercel.app/"
      ],
      "apiRoutes": [],
      "forms": [],
      "staticAssets": [],
      "graphql": []
    }
  },
  "attackPlan": {
    "recommendedChecks": [
      {
        "name": "cors",
        "priority": 1,
        "reason": "Next.js applications often have API routes that may expose CORS misconfigurations. Low-cost check with high value for modern web apps.",
        "focusAreas": [
          "API endpoints",
          "fetch requests",
          "cross-origin resource sharing"
        ]
      },
      {
        "name": "traversal",
        "priority": 2,
        "reason": "Next.js applications may have file-serving capabilities or dynamic routes that could be vulnerable to path traversal, especially in API routes or static file serving.",
        "focusAreas": [
          "/_next/ paths",
          "static file serving",
          "dynamic routes"
        ]
      },
      {
        "name": "redirect",
        "priority": 3,
        "reason": "Next.js routing and middleware may implement redirects. Worth checking even without obvious redirect parameters, as they may exist in navigation logic.",
        "focusAreas": [
          "navigation handlers",
          "middleware redirects",
          "authentication flows"
        ]
      },
      {
        "name": "xss",
        "priority": 4,
        "reason": "While no forms detected, Next.js apps may have client-side rendering with URL parameters or dynamic content that could be vulnerable to DOM-based XSS.",
        "focusAreas": [
          "URL parameters",
          "client-side rendering",
          "dynamic content injection"
        ]
      }
    ],
    "reasoning": "This is a Next.js application hosted on Vercel with no WAF detected. The reconnaissance found minimal attack surface (1 page, no forms, no API routes visible). However, Next.js applications often have hidden API routes and dynamic functionality not immediately visible. CORS is highest priority due to modern framework architecture. Traversal is important for Next.js file serving. Redirect and XSS checks are lower priority but still valuable for client-side vulnerabilities. Standard profile allows 4 checks, so all recommended checks fit within budget.",
    "skipReasons": {
      "sqli": "No forms detected and no visible database interaction points. Next.js typically uses ORMs that provide protection. Without input vectors, SQLi testing would be low-yield."
    }
  },
  "validatedFindings": [
    {
      "findingId": "4742500d-64d5-447d-84e9-5f010fd4103c",
      "isValid": true,
      "confidence": "high",
      "reasoning": "Next.js applications often require 'unsafe-inline' for styles and initial hydration scripts, but this is still a legitimate security concern. While it may be necessary for the framework to function, it does weaken XSS protections. The finding is valid as it represents a real trade-off between functionality and security that should be documented and potentially mitigated with nonces or hashes.",
      "adjustedSeverity": "low"
    },
    {
      "findingId": "e221a7e1-d822-41a4-ab2c-be3b7defd003",
      "isValid": true,
      "confidence": "high",
      "reasoning": "The 'unsafe-eval' directive is a valid security concern. While some Next.js features or third-party libraries may require eval(), it does allow dynamic code execution which increases attack surface. This is particularly concerning given the Supabase integration visible in connect-src, as compromised API responses could potentially execute arbitrary code. However, this may be required for the application to function properly.",
      "adjustedSeverity": "low"
    }
  ]
}